<!DOCTYPE html>
<html>
<title>Send</title>
<meta charset="UTF-8" name="viewport"
	content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="http://www.w3schools.com/lib/w3.css">
<link rel="stylesheet"
	href="https://fonts.googleapis.com/css?family=Raleway">
<link rel="stylesheet"
	href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<link href="https://fonts.googleapis.com/icon?family=Material+Icons"
	rel="stylesheet">

<!-- Jquery -->
<script
	src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
<script src="js/general.js"></script>

<style>
html, body, h1, h2, h3, h4, h5 {
	font-family: "Raleway", sans-serif
}
</style>

<script type="text/javascript">
	function getExpenseLists() {
		return [ {
			name : 'Troskovnik 2017'
		}, {
			name : 'Troskovnik 2015'
		}, {
			name : 'Troskovnik 2014'
		}, {
			name : 'Troskovnik 2013'
		} ];

	}
</script>

<!-- Skup fja za upravljanje trazilicom i slanjem troskovnika -->
<script type="text/javascript">
	function displayUsers(users, searchParameter, parameterValue) {
		var hookup = $("#searchResultCheckboxHookup").empty();
		if (users.length == 0) {
			hookup
					.append("Rezultati pretrage, označite kome želite poslat troškovnik<p>");

			for (var i = 0; i < users.length; ++i) {
				var checkboxTemplate = $("#checkboxTemplate");
				var cloned = checkboxTemplate.clone().removeAttr("style")
						.removeAttr("id");
				var html = "";
				html += "Ime: " + users[i].firstName + "  Prezime: "
						+ users[i].lastName + "  ";
				cloned.children("label").html(html);
				hookup.append(cloned);
			}

			hookup
					.append("<button class='w3-btn w3-red w3-round-large' onclick='sendExpenseList()'>Pošalji troškovnik</button><p>")
		} else {
			hookup.append("Za parametar pretrage'" + searchParameter
					+ "'i vrijednost paramtera '" + parameterValue
					+ "'ne postoji niti jedan rezultat rezultat.<p>");
		}
	}

	function searchForUsers() {
		var searchParameter = $("select[name='searchParametersOptions']").find(
				":selected").val();
		var parameterValue = $("#parameterValue").val();
		if (parameterValue == "") {
			return;
		}

		$.ajax({
			type : 'GET',
			url : "http://localhost:8080/baza-podataka/service/users/"
					+ searchParameter + "/" + parameterValue,
			crossDomain : true,
			dataType : 'json',
			success : function(responseData, textStatus, jqXHR) {
				displayUsers(responseData, searchParameter, parameterValue);
			},
			error : function(responseData, textStatus, errorThrown) {
				alert('GET failed.');
			}
		});

	}

	function searchForExpenseLists() {
		var hookup = $("#expenseListCheckboxHookup").empty();

		var expenseLists = getExpenseLists();
		if (expenseLists.lenght != 0) {
			hookup
					.append("<label style='font-size: 20px' >Troškovnici za slanje</label>");
			for (var i = 0; i < expenseLists.length; ++i) {
				var checkboxTemplate = $("#checkboxTemplate");
				var cloned = checkboxTemplate.clone().removeAttr("style")
						.removeAttr("id");
				cloned.children("label").html(expenseLists[i].name);
				hookup.append(cloned);
			}
		} else {
			hookup
					.append("<label style='font-size: 20px'>Za slanje troškovnika potrebno je prvo izraditi jedan. </label>");
		}
	}
</script>
<body class="w3-light-grey">

	<!-- TEMPLATES -->
	<p style="display: none" id="checkboxTemplate">
		<input class="w3-check" type="checkbox"> <label
			class="w3-validate"></label>
	</p>

	<!-- !PAGE CONTENT! -->
	<div class="w3-main" style="margin-left: 300px; margin-top: 43px;">

		<div class="w3-container w3-card-4 w3-white" id="sendExpenseListsDiv">

			<h2>Pošalji troškovnik</h2>

			<div class="w3-container w3-card-4 w3-white"
				id="expenseListCheckboxHookup">
				<button class="w3-btn w3-teal w3-round-large"
					onclick="searchForExpenseLists()">Narihtaj na home</button>
			</div>
			<hr>

			<form class="w3-container w3-card-4 w3-white" id="searchContainter" action="javascript:void(0);">
				<label style="font-size: 20px">Parametar pretrage</label> <select
					class="w3-select w3-border w3-hover-blue w3-round"
					name="searchParametersOptions"
					onchange="$('parameterValueLable').html(this.options[this.selectedIndex].innerHTML)">
					<option value="username" selected>Korisničko ime</option>
					<option value="firstName">Ime</option>
					<option value="lastName">Prezime</option>
					<option value="email">Email adresa</option>
				</select>



				<p>
					<label id="parameterValueLable" style="font-size: 20px"
						style="margin: 0px; padding: 0px;">Korisničko ime</label> <input
						class="w3-input w3-border w3-animate-input  w3-round"
						type="text" style="width: 30%" id="parameterValue"
						required="required">

				<p>

					<button class="w3-btn w3-teal w3-round-large"
						onclick="searchForUsers()">Pretrazi></button>
				<p>
				<div id="searchResultCheckboxHookup"></div>


			</form>
			<hr>

		</div>
		<!-- End page content -->
	</div>
</body>
</html>